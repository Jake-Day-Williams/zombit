How to build a reddit clone with Ruby on Rails that includes sorting by vote rank and nested comments.

I'm using rails 5.0.0.1 for this tutorial. I recommend using the same version but it's not required. Here's some helpful commands if you're going to use the same version:
<pre class="language-bash"><code class="language-bash">$ rails -v   #Shows your current rails version
$ gem list ^rails$   #List locally installed rails versions
$ gem install rails --version=5.0.0.1   #Installs a specific version of rails</code></pre>
When creating a new rails app we can specify which version to use. We'll start the tutorial off by doing just that.
<pre><code class="language-bash"> $ rails _5.0.0.1_ new reddit_clone</code></pre>

We're going to zoom through these steps. I include them for the new learners.
<pre><code class="language-bash">$ cd reddit_clone   #Change into your new app.
$ git init          #Initialize git
$ git add .         #Add everything to git
$ git commit -m "Initial commit"   #Commit to git
$ rails s                          #Start the rails server</code></pre>

Open your browser and visit localhost:3000
You should see the rails welcome page.

<img class="aligncenter size-medium wp-image-563" src="http://wildacademy.com/wp-content/uploads/2016/12/Screen-Shot-2016-12-15-at-8.56.29-PM-294x300.png" alt="rails front page" width="294" height="300" />

That means everything is good to go.

<h3>The Post Model</h3>
There are four initial models in our application. Posts, Users, Comments, and Votes

We're going to create the Post model first. It's good to start thinking about the relationships this model will have with the other three.

A Post will:
- Belong to a User.
- Have many Comments.
- Have many Votes.

(A Post will also belong to Channel when we include that model later on.)

Reddit has two types of posts:
1. Text Posts
2. Links

Text posts when clicked will take the user to the posts comment page with the body of the text at the top of the page while link posts will take the user to the shared URL. Below is an example. The first one is link based and the second is text based.

<img class="aligncenter size-medium wp-image-577" src="http://wildacademy.com/wp-content/uploads/2016/12/Screen-Shot-2016-12-16-at-11.23.37-AM-300x75.png" alt="Screenshot of reddit" width="300" height="75" />

When generating our model we'll want to include attributes for both types.
<pre><code class="language-bash">$ rails generate model Post title:string url:string body:text</code></pre>
This will generate model and migration files for Post.

Let's migrate.
<pre><code class="language-bash">$ rake db:migrate</code></pre>

Open the routes.rb file and add resources for the Posts.
<pre><code class="language-ruby">Rails.application.routes.draw do
  resources :posts
  root "posts#index"
end</code></pre>

We need a controller and views for our posts.
<pre><code class="language-bash">$ rails generate controller posts</code></pre>

Open up the newly generated posts_controller.rb and add a index action.
<pre class="language-ruby"><code class="language-ruby">class PostsController < ApplicationController
  def index
  end
end</code></pre>

<h3>Hello Haml</h3>
We're going to use haml instead of erb for our view files. Haml takes less writing and is easier to read because it removes all the noise. If you haven't used Haml before then this tutorial just got even better for you.

Add the haml-rails gem to your gemfile.
<pre><code class="language-ruby">gem "haml-rails", "~> 0.9"</code></pre>

And bundle.
<pre><code class="language-bash">$ bundle</code></pre>

After haml-rails is installed you can convert application.html.erb to application.html.haml with this command:
<pre><code class="language-bash">$ rails generate haml:application_layout convert</code></pre>

You can delete the original erb file now.
<pre><code class="language-bash">$ rm app/views/layouts/application.html.erb</code></pre>

Create a view file for the post index action add a heading to it. (Notice html.haml is used as the file extension instead of html.erb)
<pre><code class="language-haml">%h2 Hello, this is the index page for posts.</code></pre>

Restart your rails server and visit localhost:3000.

If this is your first time using Haml then <a href="http://htmltohaml.com/">htmltohaml</a> and <a href="https://haml2erb.org/">haml2erb</a> will come in handy.

<h3>Install Bootstrap</h3>
We'll use bootstrap for styling.

Add the bootstrap-sass gem to your Gemfile.
<pre><code class="language-ruby">gem 'bootstrap-sass', '~> 3.3.6'</code></pre>

ps. Don't forget to bundle after.

Import Bootstrap styles at the bottom of app/assets/stylesheets/application.scss
<pre><code class="language-scss">@import "bootstrap-sprockets";
@import "bootstrap";</code></pre>

NOTE: Should we remove the *= require_self and *= require_tree . ?

Require Bootstrap Javascripts in app/assets/javascripts/application.js
<pre><code class="language-javascript">//= require jquery
//= require bootstrap-sprockets</code></pre>

Restart your rails server and visit localhost:3000. You should see the font style change. You're good to go.

<h3>Creating a New Post</h3>
Let's create methods for the creating a new post in the post controller.
<pre><code class="language-ruby">class PostsController < ApplicationController

  def index
    @posts = Post.all
  end

  def show
  end

  def new
    @post = Post.new
  end

  def create
    @post = Post.new(post_params)
    if @post.save
      redirect_to root_path
    else
      render 'new'
    end
  end


  private

  def post_params
    params.require(:post).permit(:title, :url, :body)
  end

end</code></pre>

Create the view file for new post.   app>views>posts>new.html.haml
Add this simple line to it.
<pre><code class="language-ruby">= render 'form'</code></pre>

We're going to create a partial called form that the new file will render.
In the posts folder create the form partial app>views>posts>_form.html.erb
Add this code to our new partial:
<pre><code class="language-ruby">= form_for @post do |f|
  = f.label :title
  = f.text_field :title
  %br
  = f.label :url
  = f.text_field :url
  %br
  = f.label :body
  = f.text_area :body
  %br
  = f.submit "Submit"</code></pre>

This will be ugly. We'll make it legit later.
Head over to localhost:3000/posts/new
Fill out the form and create your first post. Make sure to give it a title, any url, and some text on the body field.

After hitting Submit you'll see that we were redirected back to the index page. We want to display all our posts on this page.

Open index.html.haml and add a do loop that will display each post.
<pre><code class="language-ruby">%h2 Hello, this is the index page for posts.
- @posts.each do |post|
  = link_to post.title, post.url</code></pre>








.media
  .media-left
    a href="#"
      img.media-object alt=("Generic placeholder image") src="..." /
  .media-body
    h4.media-heading Top aligned media
    p Cras sit amet nibh libero, in gravida nulla. Nulla vel metus scelerisque ante sollicitudin commodo. Cras purus odio, vestibulum in vulputate at, tempus viverra turpis. Fusce condimentum nunc ac nisi vulputate fringilla. Donec lacinia congue felis in faucibus.
    p Donec sed odio dui. Nullam quis risus eget urna mollis ornare vel eu leo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.













ds
